<%= form_with(model: usuario, id: 'form-usuario', local: true, data: { controller: 'usuarios' }) do |form| %>
  <% if usuario.errors.any? %>
    <div id="error_explanation">
      <div class="alert-error">
        <%= pluralize(usuario.errors.count, "erro(s)") %>.
      </div>

      <ul>
        <% usuario.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <input type="hidden" name="usuario[id]" value="<%= usuario.id %>" data-target="usuarios.id" />
  <input type="hidden" name="usuario[conta_attributes][ativa]" value="true" />

  <div class="form-group">
    <%= form.label :nome %>
    <%= form.text_field :nome, class: "form-control", required: true %>
  </div>

  <div class="form-group">
    <%= form.label :cpf, 'CPF' %>
    <%= form.text_field :cpf, class: "form-control", style: usuario.id ? "cursor: not-allowed;" : '', id: 'cpf', required: true,
    onkeypress: "return event.charCode >= 48 && event.charCode <= 57",
    disabled: usuario.id,
    data: {
      target: 'usuarios.cpf'
    } %>

    <% unless usuario.id %>
      <button type="button" role="button" class="form-control bt btn-light" data-target="usuarios.buttonGerarCPF"
        data-action="usuarios#gerarCPF">Gerar CPF</button>
    <% end %>
  </div>

  <div class="form-group">
    <%= form.label :password, 'Senha' %>
    <%= form.password_field :password, class: "form-control" %>
  </div>

  <div class="form-group">
    <%= form.label :password_confirmation, 'Confirmar Senha' %>
    <%= form.password_field :password_confirmation, class: "form-control" %>
  </div>

  <button type="submit" class="btn btn-dark float-right" data-action="usuarios#salvar"><%= usuario.id ? 'Atualizar Cadastro' : 'Cadastrar' %></button>
<% end %>
